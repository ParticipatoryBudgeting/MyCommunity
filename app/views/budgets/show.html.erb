<%= render :partial => "form" %>

<script type="text/javascript">
  $('.boxBottom .postar').bind('click', function() {
  	var error = false;

    	
    if (!error) {
    	var data = {
        	budget: {
        		id: "<%= @budget.id %>",
		        name: $('#newCauseForm input[name=name]').val(),
		        type: $('#newCauseForm input[name=type]').val(),
		        from: $('#newCauseForm input[name=from]').val(),
		        to: $('#newCauseForm input[name=to]').val(),
		        value: $('#newCauseForm input[name=value]').val(),
		        participants_count: $('#newCauseForm input[name=participants_count]').val()
	      	}
      	};
        
     	$.ajax({
       	url: '<%= update_budget_path %>',
       	data: data,
       	dataType: 'json',
       	success: function(result) {
     			if (result.success) {
            var budget = result.budget.budget;
            updateRow(budget);   
           	$.closePopupLayer();

     			}
       	} 
     	});
    }
  });

  var updateRow = function(row){
    var budget = $("#budget-"+row.id);
    budget.find(".name").text(row.name);
    budget.find(".type").text(row.type);
    budget.find(".from").text(row.from);
    budget.find(".to").text(row.to);
    budget.find(".participants_count").text(row.participants_count);
    budget.find(".value").text(row.value);
  }

</script>
